API Deprecations

En Kubernetes, les API deprecation (dÃ©prÃ©ciations dâ€™API) signifient que certaines
versions dâ€™API vont Ãªtre supprimÃ©es dans une future version. Cela arrive
rÃ©guliÃ¨rement pour remplacer des versions obsolÃ¨tes par des versions stables (GA) ou amÃ©liorÃ©es.

ğŸ“† Cycle de dÃ©prÃ©ciation dans Kubernetes
Une API est d'abord dÃ©prÃ©ciÃ©e (deprecated), ce qui gÃ©nÃ¨re un avertissement lors de son usage.
Elle est retirÃ©e (removed) dans une future version majeure (souvent +2 versions plus tard).
Exemple : dÃ©prÃ©ciÃ©e en v1.19 â†’ supprimÃ©e en v1.22
â— Exemples cÃ©lÃ¨bres de dÃ©prÃ©ciations

Ressource	                      Ancienne API (supprimÃ©e)	     Nouvelle API	           SupprimÃ©e en version
Deployment	                    extensions/v1beta1	           apps/v1	               v1.16
Ingress	                        extensions/v1beta1	           networking.k8s.io/v1	   v1.22
CronJob	                        batch/v1beta1	                 batch/v1	               v1.25
PodDisruptionBudget	            policy/v1beta1	               policy/v1	             v1.25
HorizontalPodAutoscaler	        autoscaling/v1, v2beta2	       autoscaling/v2	         v1.26 (pour v2beta2)
CustomResourceDefinition (CRD)	apiextensions.k8s.io/v1beta1	 v1	                     v1.22

ğŸ” Comment savoir si vos manifests utilisent des API dÃ©prÃ©ciÃ©es ?
1. Outil pluto (open source) :
DÃ©tecte automatiquement les API dÃ©prÃ©ciÃ©es dans vos YAML :

pluto detect-files -d ./manifests
ğŸ‘‰ https://github.com/FairwindsOps/pluto

2. Audit via kube-apiserver (si activÃ©) :
Certaines installations activent lâ€™audit pour loguer les warnings de dÃ©prÃ©ciation.

3. Regarder les warnings de kubectl :
Quand vous appliquez un fichier YAML :

kubectl apply -f your.yaml
Sâ€™il y a une API dÃ©prÃ©ciÃ©e, un warning sâ€™affiche.

ğŸ“Œ Bonnes pratiques

Toujours utiliser la derniÃ¨re version stable (GA) dâ€™une API.
Lire les changelogs de chaque version Kubernetes.
Si vous gÃ©rez plusieurs clusters, assurez-vous que vos YAML sont compatibles avec la version la plus basse.
Surveillez les API Deprecated dans les annonces officielles :
https://kubernetes.io/docs/home/
